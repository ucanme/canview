# ä¿¡å·åº“ç®¡ç†åŠŸèƒ½é‡æ–°è§„åˆ’æ–¹æ¡ˆ

## ä¸€ã€å½“å‰å®ç°åˆ†æ

### 1.1 ç°æœ‰åŠŸèƒ½æ¨¡å—

**æ•°æ®æ¨¡å‹å±‚** (`src/models/library.rs`)
- âœ… `SignalLibrary` - ä¿¡å·åº“
- âœ… `LibraryVersion` - ç‰ˆæœ¬ç®¡ç†
- âœ… `ChannelDatabase` - é€šé“æ•°æ®åº“é…ç½®
- âœ… `DatabaseType` - æ•°æ®åº“ç±»å‹æšä¸¾
- âœ… å®Œæ•´çš„åºåˆ—åŒ–æ”¯æŒ

**ä¸šåŠ¡é€»è¾‘å±‚** (`src/library/mod.rs`)
- âœ… `LibraryManager` - åº“ç®¡ç†å™¨
- âœ… CRUDæ“ä½œï¼ˆåˆ›å»ºã€åˆ é™¤ã€æŸ¥æ‰¾ï¼‰
- âœ… ç‰ˆæœ¬ç®¡ç†ï¼ˆæ·»åŠ ã€åˆ é™¤ç‰ˆæœ¬ï¼‰
- âœ… æ•°æ®åº“éªŒè¯å’Œç»Ÿè®¡
- âœ… DBC/LDFæ–‡ä»¶åŠ è½½

**UIå±‚** (`src/ui/views/library_view.rs`)
- âœ… åº“åˆ—è¡¨ç»„ä»¶
- âœ… ç‰ˆæœ¬åˆ—è¡¨ç»„ä»¶
- âœ… åŸºç¡€äº¤äº’é€»è¾‘

### 1.2 å½“å‰é—®é¢˜

**æ¶æ„é—®é¢˜**
- âŒ UIç»„ä»¶æœªå®Œå…¨é›†æˆåˆ°ä¸»åº”ç”¨
- âŒ åŠŸèƒ½åˆ†æ•£åœ¨å¤šä¸ªæ¨¡å—ï¼Œç¼ºå°‘ç»Ÿä¸€çš„å·¥ä½œæµ
- âŒ ç¼ºå°‘ç”¨æˆ·å¼•å¯¼å’Œå¸®åŠ©ä¿¡æ¯

**ç”¨æˆ·ä½“éªŒé—®é¢˜**
- âŒ æ²¡æœ‰æ¸…æ™°çš„"å¯¼å…¥ â†’ ç®¡ç† â†’ ä½¿ç”¨"æµç¨‹
- âŒ ç¼ºå°‘å¿«é€Ÿæ“ä½œå…¥å£
- âŒ ç‰ˆæœ¬åˆ‡æ¢ä¸å¤Ÿç›´è§‚
- âŒ å¤šé€šé“é…ç½®å¤æ‚åº¦è¾ƒé«˜

**åŠŸèƒ½ç¼ºå¤±**
- âŒ æ²¡æœ‰æ•°æ®åº“æ–‡ä»¶æµè§ˆå™¨
- âŒ ç¼ºå°‘æ‰¹é‡å¯¼å…¥åŠŸèƒ½
- âŒ æ²¡æœ‰åº“çš„æœç´¢å’Œè¿‡æ»¤
- âŒ ç¼ºå°‘ä½¿ç”¨å†å²è®°å½•
- âŒ æ²¡æœ‰åº“çš„å¯¼å‡º/åˆ†äº«åŠŸèƒ½

---

## äºŒã€é‡æ–°è®¾è®¡ç›®æ ‡

### 2.1 æ ¸å¿ƒåŸåˆ™

1. **ç®€å•ä¼˜å…ˆ** - ä»å•æ–‡ä»¶å¿«é€Ÿå¯¼å…¥å¼€å§‹ï¼Œé€æ­¥å¼•å¯¼åˆ°é«˜çº§åŠŸèƒ½
2. **å¯è§†åŒ–ä¼˜å…ˆ** - ç”¨å›¾å½¢ç•Œé¢å±•ç¤ºåº“ã€ç‰ˆæœ¬ã€é€šé“çš„å…³ç³»
3. **æµç¨‹é©±åŠ¨** - æŒ‰å®é™…ä½¿ç”¨æµç¨‹ç»„ç»‡åŠŸèƒ½ï¼ˆå¯¼å…¥ â†’ ç®¡ç† â†’ åº”ç”¨ï¼‰
4. **æ¸è¿›å¼å¤æ‚** - åŸºç¡€åŠŸèƒ½ç®€å•ï¼Œé«˜çº§åŠŸèƒ½å¯é€‰

### 2.2 ç”¨æˆ·åœºæ™¯

**åœºæ™¯Aï¼šå¿«é€ŸæŸ¥çœ‹å•ä¸ªDBCæ–‡ä»¶**
```
ç”¨æˆ·éœ€æ±‚ï¼šæ‰“å¼€ä¸€ä¸ªBLFæ–‡ä»¶ï¼Œéœ€è¦æŸ¥çœ‹DBCä¿¡å·
æ“ä½œæµç¨‹ï¼š
1. æ‰“å¼€BLFæ–‡ä»¶
2. ç‚¹å‡»"å¯¼å…¥æ•°æ®åº“"
3. é€‰æ‹©DBCæ–‡ä»¶
4. ç«‹å³çœ‹åˆ°ä¿¡å·è§£æ
```

**åœºæ™¯Bï¼šç®¡ç†è½¦è¾†é¡¹ç›®çš„å¤šä¸ªDBCç‰ˆæœ¬**
```
ç”¨æˆ·éœ€æ±‚ï¼šç®¡ç†BMWé¡¹ç›®çš„v1.0ã€v2.0ã€v3.0ç‰ˆæœ¬
æ“ä½œæµç¨‹ï¼š
1. åˆ›å»º"BMW PT-CAN"åº“
2. å¯¼å…¥v1.0æ–‡ä»¶
3. å¯¼å…¥v2.0æ–‡ä»¶
4. åœ¨ä¸åŒç‰ˆæœ¬é—´å¿«é€Ÿåˆ‡æ¢å¯¹æ¯”
```

**åœºæ™¯Cï¼šé…ç½®å¤šé€šé“ç³»ç»Ÿ**
```
ç”¨æˆ·éœ€æ±‚ï¼šé…ç½®åŒ…å«CANé€šé“1-16å’ŒLINé€šé“1-4çš„ç³»ç»Ÿ
æ“ä½œæµç¨‹ï¼š
1. åˆ›å»º"è½¦è¾†è¯Šæ–­ç³»ç»Ÿ"åº“
2. ä¸ºæ¯ä¸ªé€šé“æ·»åŠ å¯¹åº”çš„æ•°æ®åº“
3. ä¿å­˜é…ç½®
4. åç»­ä¸€é”®åŠ è½½å®Œæ•´é…ç½®
```

---

## ä¸‰ã€æ–°UIæ¶æ„è®¾è®¡

### 3.1 æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CanView                            ğŸ”§ Settings ğŸ‘¤ Help â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ Logs  ğŸ”§ Config ğŸ“Š Analytics  ğŸ“š Library          â”‚  <- å¯¼èˆªæ 
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚             â”‚                                  â”‚    â”‚
â”‚  â”‚  Library    â”‚   Library Detail View           â”‚    â”‚
â”‚  â”‚  List       â”‚                                  â”‚    â”‚
â”‚  â”‚             â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  ğŸ“ BMW     â”‚   â”‚ Version: v1.0             â”‚  â”‚    â”‚
â”‚  â”‚  ğŸ“ Ford    â”‚   â”‚ Date: 2024-01-15          â”‚  â”‚    â”‚
â”‚  â”‚  ğŸ“ Toyota  â”‚   â”‚ Channels: 1, 2, 3         â”‚  â”‚    â”‚
â”‚  â”‚  ğŸ“ + New   â”‚   â”‚                          â”‚  â”‚    â”‚
â”‚  â”‚             â”‚   â”‚ [Load] [Edit] [Delete]   â”‚  â”‚    â”‚
â”‚  â”‚             â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚             â”‚                                  â”‚    â”‚
â”‚  â”‚             â”‚   Versions:                    â”‚    â”‚
â”‚  â”‚             â”‚   â€¢ v1.0 (current)            â”‚    â”‚
â”‚  â”‚             â”‚   â€¢ v0.9                      â”‚    â”‚
â”‚  â”‚             â”‚   â€¢ v0.8                      â”‚    â”‚
â”‚  â”‚             â”‚                                  â”‚    â”‚
â”‚  â”‚             â”‚   [+ Add Version]              â”‚    â”‚
â”‚  â”‚             â”‚                                  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                           â”‚
â”‚  Quick Actions:                                           â”‚
â”‚  [ğŸ“¥ Import DBC/LDF]  [ğŸ” Search]  [ğŸ“¤ Export]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 ä¸‰æ å¸ƒå±€ï¼ˆè¯¦æƒ…è§†å›¾ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Libraries â”‚ Versions â”‚ Channel Config                  â”‚
â”‚            â”‚          â”‚                                  â”‚
â”‚  BMW  âœ“    â”‚ v1.0 âœ“   â”‚  CH1: /path/to/ch1.dbc      [x] â”‚
â”‚  Ford      â”‚ v0.9     â”‚  CH2: /path/to/ch2.dbc      [x] â”‚
â”‚  Toyota    â”‚ v0.8     â”‚  CH3: /path/to/ch3.dbc      [x] â”‚
â”‚  + New     â”‚ + Add    â”‚  [+ Add Channel]                 â”‚
â”‚            â”‚          â”‚                                  â”‚
â”‚  Search:   â”‚          â”‚  Apply to:                       â”‚
â”‚  [_____]   â”‚          â”‚  â–¡ All channels at once         â”‚
â”‚            â”‚          â”‚  â–¡ Selected channels only       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€åŠŸèƒ½æ¨¡å—é‡æ–°è®¾è®¡

### 4.1 å¿«é€Ÿå¯¼å…¥ï¼ˆQuick Importï¼‰

**ç›®çš„ï¼š** è®©ç”¨æˆ·æœ€å¿«é€Ÿåº¦å¼€å§‹ä½¿ç”¨

**UIè®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Import Database File           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  Select a DBC or LDF file:      â”‚
â”‚  [Browse...]                    â”‚
â”‚                                 â”‚
â”‚  File: bmw_ptcan_2024.dbc       â”‚
â”‚  Type: DBC                      â”‚
â”‚  Messages: 156                  â”‚
â”‚  Signals: 1,234                 â”‚
â”‚                                 â”‚
â”‚  Options:                       â”‚
â”‚  â–¡ Add to existing library       â”‚
â”‚  â–¡ Create new library           â”‚
â”‚  Library name: [BMW PT-CAN]     â”‚
â”‚                                 â”‚
â”‚  [Cancel] [Import & Load]       â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å·¥ä½œæµç¨‹ï¼š**
1. ç”¨æˆ·ç‚¹å‡»"Import Database"æŒ‰é’®
2. é€‰æ‹©æ–‡ä»¶
3. è‡ªåŠ¨éªŒè¯å¹¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
4. ç”¨æˆ·é€‰æ‹©æ·»åŠ åˆ°ç°æœ‰åº“æˆ–åˆ›å»ºæ–°åº“
5. ç«‹å³åŠ è½½å¹¶åº”ç”¨

**ä»£ç ç»“æ„ï¼š**
```rust
// æ–°å¢ï¼šå¿«é€Ÿå¯¼å…¥æ¨¡å—
mod quick_import {
    pub struct QuickImportWizard {
        step: ImportStep,
        selected_file: Option<PathBuf>,
        validation_result: Option<DatabaseValidation>,
        target_library: Option<TargetLibrary>,
    }

    enum ImportStep {
        SelectFile,
        ReviewInfo,
        ChooseTarget,
    }
}
```

### 4.2 åº“æµè§ˆå™¨ï¼ˆLibrary Browserï¼‰

**ç›®çš„ï¼š** å¯è§†åŒ–å±•ç¤ºæ‰€æœ‰åº“å’Œç‰ˆæœ¬

**ç‰¹æ€§ï¼š**
- ğŸ“ æ ‘å½¢è§†å›¾ï¼šåº“ â†’ ç‰ˆæœ¬ â†’ é€šé“
- ğŸ” æœç´¢å’Œè¿‡æ»¤
- ğŸ·ï¸ æ ‡ç­¾ç³»ç»Ÿï¼ˆé¡¹ç›®ã€è½¦è¾†ç±»å‹ç­‰ï¼‰
- ğŸ“Š ç»Ÿè®¡ä¿¡æ¯å¡ç‰‡
- ğŸŸ¢ çŠ¶æ€æŒ‡ç¤ºï¼ˆä½¿ç”¨ä¸­ã€æœªä½¿ç”¨ã€è¿‡æœŸï¼‰

**UIè®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Library Browser                    ğŸ” [Search] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Filter: [All] [In Use] [CAN] [LIN]            â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“ BMW PT-CAN (CAN)                       â”‚   â”‚
â”‚  â”‚    3 versions â€¢ Used by CH1-3            â”‚   â”‚
â”‚  â”‚    ğŸ·ï¸ #production #diagnostics            â”‚   â”‚
â”‚  â”‚    v1.0 â€¢ v0.9 â€¢ v0.8                      â”‚   â”‚
â”‚  â”‚    [Load] [Edit] [Export]                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ ğŸ“ Ford LIN (LIN)                         â”‚   â”‚
â”‚  â”‚    1 version â€¢ Not in use                 â”‚   â”‚
â”‚  â”‚    v1.0                                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  [+ New Library]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ç‰ˆæœ¬å¯¹æ¯”ï¼ˆVersion Diffï¼‰

**ç›®çš„ï¼š** å¯¹æ¯”ä¸åŒç‰ˆæœ¬é—´çš„å·®å¼‚

**UIè®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Version Comparison: v1.0 vs v0.9               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Added Messages: 12                             â”‚
â”‚  Removed Messages: 3                             â”‚
â”‚  Modified Signals: 45                            â”‚
â”‚                                                  â”‚
â”‚  â”Œâ”€ Message Changes â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  + MSG_0x100 (New)                         â”‚   â”‚
â”‚  â”‚  + MSG_0x101 (New)                         â”‚   â”‚
â”‚  â”‚  - MSG_0x200 (Removed)                     â”‚   â”‚
â”‚  â”‚  ~ MSG_0x300 (Modified)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  [Apply v1.0] [Keep v0.9]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 å¤šé€šé“é…ç½®å™¨ï¼ˆMulti-Channel Configuratorï¼‰

**ç›®çš„ï¼š** ç®€åŒ–å¤šé€šé“ç³»ç»Ÿé…ç½®

**ç‰¹æ€§ï¼š**
- ğŸ“‹ é€šé“çŸ©é˜µè§†å›¾
- ğŸ”„ æ‰¹é‡æ“ä½œ
- ğŸ“‹ æ¨¡æ¿ä¿å­˜å’ŒåŠ è½½
- âœ… é…ç½®éªŒè¯

**UIè®¾è®¡ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Channel Configuration                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Library: BMW PT-CAN v1.0                       â”‚
â”‚                                                  â”‚
â”‚  Channel Matrix:                                 â”‚
â”‚  â”Œâ”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   â”‚  CH1  CH2  CH3  CH4  CH5  CH6  ...   â”‚   â”‚
â”‚  â”‚   â”‚  âœ“    âœ“    âœ“    âœ“    âœ“    âœ“         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚DB â”‚  ğŸ“‹   ğŸ“‹   ğŸ“‹   ğŸ“‹   ğŸ“‹   ğŸ“‹        â”‚   â”‚
â”‚  â””â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                  â”‚
â”‚  Selected: 6 channels                           â”‚
â”‚  [Apply to Selected] [Apply to All]             â”‚
â”‚                                                  â”‚
â”‚  Quick Templates:                                â”‚
â”‚  [All CAN] [All LIN] [First 8] [Custom...]      â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äº”ã€å®ç°è®¡åˆ’

### é˜¶æ®µ1ï¼šæ ¸å¿ƒåŠŸèƒ½é‡æ„ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

**ç›®æ ‡ï¼š** å»ºç«‹æ¸…æ™°çš„åŸºç¡€æ¶æ„

**ä»»åŠ¡åˆ—è¡¨ï¼š**
1. âœ… é‡æ„ `LibraryManager` APIï¼Œç®€åŒ–æ ¸å¿ƒæ“ä½œ
2. âœ… å®ç° `QuickImportWizard` ç»„ä»¶
3. âœ… åˆ›å»ºç»Ÿä¸€çš„ `LibraryService` æ¥å£
4. âœ… æ·»åŠ æ–‡ä»¶å˜æ›´ç›‘æ§ï¼ˆè‡ªåŠ¨é‡è½½ï¼‰
5. âœ… å®ç°åº“çš„æœç´¢å’Œè¿‡æ»¤

**ä»£ç ç»“æ„ï¼š**
```rust
// æ–°çš„æœåŠ¡å±‚
pub mod services {
    pub trait LibraryService {
        async fn import_file(&mut self, path: PathBuf) -> Result<ImportResult>;
        async fn load_version(&mut self, lib_id: &str, ver: &str) -> Result<()>;
        async fn switch_version(&mut self, lib_id: &str, from: &str, to: &str) -> Result<VersionDiff>;
        fn search_libraries(&self, query: &str) -> Vec<LibraryItem>;
    }
}
```

### é˜¶æ®µ2ï¼šUIç»„ä»¶å¼€å‘ï¼ˆä¼˜å…ˆçº§ï¼šé«˜ï¼‰

**ä»»åŠ¡åˆ—è¡¨ï¼š**
1. âœ… å®ç° `LibraryBrowser` ç»„ä»¶ï¼ˆæ ‘å½¢è§†å›¾ï¼‰
2. âœ… å®ç° `VersionComparisonView` ç»„ä»¶
3. âœ… å®ç° `ChannelMatrix` ç»„ä»¶
4. âœ… æ·»åŠ æ‹–æ‹½æ”¯æŒï¼ˆåº“æ’åºã€ç‰ˆæœ¬é‡æ’ï¼‰
5. âœ… å®ç°å³é”®èœå•ï¼ˆä¸Šä¸‹æ–‡æ“ä½œï¼‰

### é˜¶æ®µ3ï¼šé«˜çº§åŠŸèƒ½ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

**ä»»åŠ¡åˆ—è¡¨ï¼š**
1. âœ… æ‰¹é‡å¯¼å…¥åŠŸèƒ½
2. âœ… åº“æ¨¡æ¿ç³»ç»Ÿ
3. âœ… å¯¼å‡º/åˆ†äº«åŠŸèƒ½ï¼ˆæ‰“åŒ…åº“å’Œé…ç½®ï¼‰
4. âœ… ä½¿ç”¨ç»Ÿè®¡å’ŒæŠ¥å‘Š
5. âœ… è‡ªåŠ¨å¤‡ä»½å’Œç‰ˆæœ¬æ§åˆ¶

### é˜¶æ®µ4ï¼šä½“éªŒä¼˜åŒ–ï¼ˆä¼˜å…ˆçº§ï¼šä¸­ï¼‰

**ä»»åŠ¡åˆ—è¡¨ï¼š**
1. âœ… é”®ç›˜å¿«æ·é”®
2. âœ… æ’¤é”€/é‡åšæ”¯æŒ
3. âœ… æ“ä½œæç¤ºå’Œå¸®åŠ©
4. âœ… æ€§èƒ½ä¼˜åŒ–ï¼ˆå¤§å‹åº“åŠ è½½ï¼‰
5. âœ… ç¦»çº¿æ¨¡å¼æ”¯æŒ

---

## å…­ã€æ•°æ®æ¨¡å‹ä¼˜åŒ–

### 6.1 å¢å¼ºçš„å…ƒæ•°æ®

```rust
pub struct SignalLibrary {
    pub id: String,
    pub name: String,
    pub channel_type: ChannelType,
    pub versions: Vec<LibraryVersion>,

    // æ–°å¢å­—æ®µ
    pub tags: Vec<String>,              // æ ‡ç­¾
    pub project: Option<String>,         // å…³è”é¡¹ç›®
    pub description: String,            // æè¿°
    pub created_at: chrono::DateTime<chrono::Utc>,
    pub updated_at: chrono::DateTime<chrono::Utc>,
    pub usage_count: usize,              // ä½¿ç”¨æ¬¡æ•°
    pub last_used: Option<chrono::DateTime<chrono::Utc>>,
}

pub struct LibraryVersion {
    pub name: String,
    pub path: String,
    pub date: String,
    pub description: String,
    pub channel_databases: Vec<ChannelDatabase>,

    // æ–°å¢å­—æ®µ
    pub checksum: String,               // æ–‡ä»¶æ ¡éªŒå’Œ
    pub file_size: u64,                 // æ–‡ä»¶å¤§å°
    pub is_valid: bool,                 // éªŒè¯çŠ¶æ€
    pub validation_error: Option<String>,
    pub stats: DatabaseStats,           // è¯¦ç»†ç»Ÿè®¡
    pub author: Option<String>,         // ä½œè€…
    pub changelog: String,              // å˜æ›´æ—¥å¿—
}
```

### 6.2 é…ç½®æŒä¹…åŒ–

```rust
pub struct LibraryConfig {
    // åº“é…ç½®
    pub libraries: Vec<SignalLibrary>,

    // ç”¨æˆ·åå¥½
    pub auto_reload: bool,
    pub default_library: Option<String>,
    pub view_preferences: ViewPreferences,

    // ä½¿ç”¨ç»Ÿè®¡
    pub recent_libraries: Vec<RecentLibrary>,
    pub usage_stats: HashMap<String, LibraryStats>,
}

pub struct RecentLibrary {
    pub library_id: String,
    pub version_name: String,
    pub last_used: chrono::DateTime<chrono::Utc>,
    pub use_count: usize,
}
```

---

## ä¸ƒã€APIè®¾è®¡

### 7.1 æ ¸å¿ƒAPI

```rust
impl LibraryManager {
    // === åŸºç¡€CRUD ===
    pub fn create_library(&mut self, name: String, ty: ChannelType)
        -> Result<&SignalLibrary>;
    pub fn delete_library(&mut self, id: &str) -> Result<()>;
    pub fn update_library(&mut self, id: String, updates: LibraryUpdates)
        -> Result<()>;

    // === ç‰ˆæœ¬ç®¡ç† ===
    pub fn add_version(&mut self, lib_id: &str, version: VersionSpec)
        -> Result<()>;
    pub fn remove_version(&mut self, lib_id: &str, ver: &str)
        -> Result<()>;
    pub fn switch_version(&mut self, lib_id: &str, to: &str)
        -> Result<VersionDiff>;

    // === æŸ¥è¯¢å’Œæœç´¢ ===
    pub fn list_libraries(&self) -> Vec<LibraryItem>;
    pub fn search(&self, query: &SearchQuery) -> Vec<LibraryItem>;
    pub fn get_library_detail(&self, id: &str) -> LibraryDetail;

    // === æ‰¹é‡æ“ä½œ ===
    pub fn batch_import(&mut self, files: Vec<PathBuf>)
        -> Vec<ImportResult>;
    pub fn batch_delete(&mut self, ids: Vec<&str>)
        -> Result<Vec<String>>;

    // === é«˜çº§åŠŸèƒ½ ===
    pub fn compare_versions(&self, lib_id: &str, v1: &str, v2: &str)
        -> VersionDiff;
    pub fn export_library(&self, id: &str, format: ExportFormat)
        -> Result<Vec<u8>>;
    pub fn import_library(&mut self, data: &[u8])
        -> Result<ImportResult>;
}
```

### 7.2 å¼‚æ­¥API

```rust
#[async_trait]
pub trait AsyncLibraryService {
    async fn validate_file(&self, path: PathBuf)
        -> Result<DatabaseValidation>;
    async fn load_database(&self, path: PathBuf, ty: ChannelType)
        -> Result<Database>;
    async fn auto_reload(&self, lib_id: &str)
        -> Result<ReloadResult>;
}
```

---

## å…«ã€ç”¨æˆ·å·¥ä½œæµè®¾è®¡

### 8.1 é¦–æ¬¡ä½¿ç”¨æµç¨‹

```
å¯åŠ¨åº”ç”¨
   â”‚
   â”œâ”€> æ¬¢è¿å‘å¯¼
   â”‚   â”œâ”€> "è¦æŸ¥çœ‹BLFæ–‡ä»¶ï¼Ÿ"
   â”‚   â”‚   â””â”€> [æ‰“å¼€BLF] â†’ è‡ªåŠ¨æ£€æµ‹DBC â†’ æ¨èå¯¼å…¥
   â”‚   â”‚
   â”‚   â””â”€> "æœ‰DBC/LDFæ–‡ä»¶ï¼Ÿ"
   â”‚       â””â”€> [å¯¼å…¥æ–‡ä»¶] â†’ åˆ›å»ºåº“ â†’ ç«‹å³ä½¿ç”¨
   â”‚
   â””â”€> å®Œæˆå¼•å¯¼ â†’ è¿›å…¥ä¸»ç•Œé¢
```

### 8.2 æ—¥å¸¸ä½¿ç”¨æµç¨‹

```
æ‰“å¼€åº”ç”¨
   â”‚
   â”œâ”€> æœ€è¿‘ä½¿ç”¨çš„åº“ï¼ˆè‡ªåŠ¨æ˜¾ç¤ºåœ¨é¡¶éƒ¨ï¼‰
   â”‚   â””â”€> ç‚¹å‡»å³å¯åŠ è½½
   â”‚
   â”œâ”€> æ‰“å¼€BLFæ–‡ä»¶
   â”‚   â””â”€> è‡ªåŠ¨åŠ è½½å…³è”çš„åº“
   â”‚
   â””â”€> åˆ‡æ¢åº“ç‰ˆæœ¬
       â””â”€> Library Browser â†’ é€‰æ‹©ç‰ˆæœ¬ â†’ Load
```

---

## ä¹ã€å…³é”®æŠ€æœ¯å†³ç­–

### 9.1 æ€§èƒ½ä¼˜åŒ–

**é—®é¢˜ï¼š** å¤§å‹DBCæ–‡ä»¶ï¼ˆ>10MBï¼‰åŠ è½½ç¼“æ…¢

**è§£å†³æ–¹æ¡ˆï¼š**
1. **å»¶è¿ŸåŠ è½½** - åªåŠ è½½å…ƒæ•°æ®ï¼Œæ¶ˆæ¯å†…å®¹æŒ‰éœ€åŠ è½½
2. **ç¼“å­˜æœºåˆ¶** - ç¼“å­˜è§£æåçš„æ•°æ®åº“å¯¹è±¡
3. **å¢é‡åŠ è½½** - æ”¯æŒåˆ†å—åŠ è½½å¤§å‹æ–‡ä»¶
4. **åå°éªŒè¯** - åœ¨åå°çº¿ç¨‹ä¸­éªŒè¯æ–‡ä»¶

```rust
pub struct CachedDatabase {
    metadata: DatabaseMetadata,  // è½»é‡çº§å…ƒæ•°æ®
    db: OnceLock<Database>,        // å»¶è¿ŸåŠ è½½çš„å®Œæ•´æ•°æ®åº“
    cache_key: String,             // ç¼“å­˜é”®
}
```

### 9.2 æ•°æ®ä¸€è‡´æ€§

**é—®é¢˜ï¼š** é…ç½®æ–‡ä»¶å’Œå†…å­˜çŠ¶æ€å¯èƒ½ä¸åŒæ­¥

**è§£å†³æ–¹æ¡ˆï¼š**
1. **åŸå­æ›´æ–°** - ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ + é‡å‘½å
2. **å˜æ›´æ—¥å¿—** - è®°å½•æ‰€æœ‰å˜æ›´æ“ä½œ
3. **è‡ªåŠ¨ä¿å­˜** - å®šæ—¶è‡ªåŠ¨ä¿å­˜
4. **å†²çªæ£€æµ‹** - æ£€æµ‹æ–‡ä»¶è¢«å¤–éƒ¨ä¿®æ”¹

### 9.3 é”™è¯¯å¤„ç†

**åŸåˆ™ï¼š**
- ç”¨æˆ·å‹å¥½çš„é”™è¯¯æ¶ˆæ¯
- è‡ªåŠ¨æ¢å¤ï¼ˆå°½å¯èƒ½ï¼‰
- è¯¦ç»†çš„æ—¥å¿—è®°å½•
- æä¾›è§£å†³å»ºè®®

```rust
pub enum LibraryError {
    FileNotFound { path: String, suggestion: String },
    InvalidDatabase { error: String, line: Option<usize> },
    VersionConflict { current: String, attempted: String },
    LibraryInUse { library: String, channels: Vec<u16> },

    // è‡ªåŠ¨æ¢å¤
    #[serde(skip)]
    recover: Option<RecoveryAction],
}

pub enum RecoveryAction {
    Retry,
    Skip,
    UseBackup(PathBuf),
    ResetToDefault,
}
```

---

## åã€æµ‹è¯•ç­–ç•¥

### 10.1 å•å…ƒæµ‹è¯•

```rust
#[cfg(test)]
mod tests {
    // LibraryManageræ ¸å¿ƒåŠŸèƒ½
    test_create_library();
    test_add_version();
    test_delete_library_in_use();
    test_version_comparison();

    // æ•°æ®éªŒè¯
    test_validate_dbc();
    test_validate_ldf();
    test_detect_file_type();

    // å¹¶å‘æµ‹è¯•
    test_concurrent_access();
    test_race_conditions();
}
```

### 10.2 é›†æˆæµ‹è¯•

```rust
#[tokio::test]
async test_import_workflow() {
    // æ¨¡æ‹Ÿå®Œæ•´çš„å¯¼å…¥æµç¨‹
    let manager = LibraryManager::new();

    // 1. åˆ›å»ºåº“
    manager.create_library("Test".into(), ChannelType::CAN)?;

    // 2. æ·»åŠ ç‰ˆæœ¬
    manager.add_version("lib_xxx", "v1.0".into(), path.into(), desc.into())?;

    // 3. åŠ è½½å¹¶éªŒè¯
    let db = manager.load_database(&path, ChannelType::CAN)?;
    assert!(db.message_count() > 0);
}
```

### 10.3 UIæµ‹è¯•

```rust
#[test]
fn test_library_browser_render() {
    // æµ‹è¯•åº“æµè§ˆå™¨æ¸²æŸ“
    let libraries = create_test_libraries();
    let element = render_library_list(&libraries, &None, &[], cx);

    // éªŒè¯æ¸²æŸ“ç»“æœ
    assert!(element.text().contains("BMW"));
}
```

---

## åä¸€ã€æ–‡æ¡£å’ŒåŸ¹è®­

### 11.1 ç”¨æˆ·æ–‡æ¡£

1. **å¿«é€Ÿå¼€å§‹æŒ‡å—** - 5åˆ†é’Ÿä¸Šæ‰‹
2. **å®Œæ•´æ•™ç¨‹** - è¯¦ç»†åŠŸèƒ½è¯´æ˜
3. **è§†é¢‘æ•™ç¨‹** - æ¼”ç¤ºå¸¸è§æ“ä½œ
4. **FAQ** - å¸¸è§é—®é¢˜è§£ç­”

### 11.2 å¼€å‘è€…æ–‡æ¡£

1. **æ¶æ„è®¾è®¡æ–‡æ¡£**
2. **APIå‚è€ƒæ‰‹å†Œ**
3. **è´¡çŒ®æŒ‡å—**
4. **æ•…éšœæ’é™¤æŒ‡å—**

---

## åäºŒã€æˆåŠŸæŒ‡æ ‡

### 12.1 ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

- â±ï¸ å¯¼å…¥æ—¶é—´ < 5ç§’ï¼ˆæ™®é€šDBCæ–‡ä»¶ï¼‰
- ğŸ¯ æ–°ç”¨æˆ·5åˆ†é’Ÿå†…å®Œæˆé¦–æ¬¡å¯¼å…¥
- ğŸ“Š ç‰ˆæœ¬åˆ‡æ¢æ—¶é—´ < 1ç§’
- ğŸ’¾ é…ç½®ä¿å­˜/åŠ è½½ < 100ms

### 12.2 åŠŸèƒ½è¦†ç›–ç‡

- âœ… æ”¯æŒDBCå’ŒLDFæ–‡ä»¶
- âœ… å•é€šé“å’Œå¤šé€šé“é…ç½®
- âœ… ç‰ˆæœ¬ç®¡ç†å’Œå¯¹æ¯”
- âœ… æœç´¢å’Œè¿‡æ»¤
- âœ… æ‰¹é‡æ“ä½œ
- âœ… å¯¼å…¥/å¯¼å‡º

### 12.3 ç¨³å®šæ€§æŒ‡æ ‡

- ğŸ› é›¶å´©æºƒï¼ˆå¯¼å…¥ã€åˆ‡æ¢ã€åŠ è½½ï¼‰
- ğŸ”„ 100%æ•°æ®ä¸€è‡´æ€§
- ğŸ“‰ < 1%æ–‡ä»¶éªŒè¯å¤±è´¥
- ğŸš€ å“åº”æ—¶é—´ < 100msï¼ˆUIæ“ä½œï¼‰

---

## åä¸‰ã€å®æ–½æ—¶é—´è¡¨

### Phase 1ï¼ˆç¬¬1-2å‘¨ï¼‰ï¼šåŸºç¡€é‡æ„
- é‡æ„LibraryManager API
- å®ç°QuickImportWizard
- æ·»åŠ æœç´¢å’Œè¿‡æ»¤

### Phase 2ï¼ˆç¬¬3-4å‘¨ï¼‰ï¼šUIå¼€å‘
- LibraryBrowserç»„ä»¶
- ç‰ˆæœ¬å¯¹æ¯”è§†å›¾
- å¤šé€šé“é…ç½®å™¨

### Phase 3ï¼ˆç¬¬5-6å‘¨ï¼‰ï¼šé«˜çº§åŠŸèƒ½
- æ‰¹é‡å¯¼å…¥
- æ¨¡æ¿ç³»ç»Ÿ
- å¯¼å‡º/åˆ†äº«

### Phase 4ï¼ˆç¬¬7-8å‘¨ï¼‰ï¼šä¼˜åŒ–å’Œæµ‹è¯•
- æ€§èƒ½ä¼˜åŒ–
- ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- æµ‹è¯•å’Œæ–‡æ¡£

---

## åå››ã€æ€»ç»“

æœ¬é‡æ–°è§„åˆ’æ–¹æ¡ˆèšç„¦äºï¼š

âœ… **ç”¨æˆ·ä¼˜å…ˆ** - ç®€åŒ–æ ¸å¿ƒæµç¨‹ï¼Œå¿«é€Ÿä¸Šæ‰‹
âœ… **åŠŸèƒ½å®Œæ•´** - è¦†ç›–ä»å¯¼å…¥åˆ°åº”ç”¨çš„å…¨æµç¨‹
âœ… **å¯æ‰©å±•** - æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ·»åŠ æ–°åŠŸèƒ½
âœ… **é«˜æ€§èƒ½** - ä¼˜åŒ–å¤§å‹åº“çš„åŠ è½½å’Œåˆ‡æ¢
âœ… **å¯ç»´æŠ¤** - æ¸…æ™°çš„æ¶æ„ï¼Œå®Œå–„çš„æµ‹è¯•

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨ï¼š**
1. ä¸å›¢é˜Ÿè®¨è®ºå¹¶ç¡®è®¤æ–¹æ¡ˆ
2. åˆ›å»ºè¯¦ç»†çš„UIåŸå‹
3. å¼€å§‹Phase 1å®æ–½
